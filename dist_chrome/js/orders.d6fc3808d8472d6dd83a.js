"use strict";(self.webpackChunkcatalog=self.webpackChunkcatalog||[]).push([[486],{72205:(e,t,r)=>{r.r(t),r.d(t,{default:()=>G});var n=r(30624),a=r.n(n),o=r(15040),l=r(66678),i=r(91703);var s=r(45237),c=r(54213),d=r(66031),u=r(92223),p=r(32875),f=r(40825),m=r(41436),y=r(2482),v=r(85132),g=r(11608),h=r(49827),E=r(8666),b=r(62410),F=r(32642),Z=r(35388),w=r(20697),x=r(36722),T=r(31644),D=r(42413),B=function(){return(B=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};var I=r(77172),O=r(81624),_=r(7247),C=r(44058),A=r(97881),S=r(40229),P=r(56682),k=r(23349),N=function(){return(N=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},R=(0,O.Z)((function(e,t,r,n){var a;void 0===t&&(t=_.he),n(!0),r((null===(a=window.catalog)||void 0===a?void 0:a.standalone)?(0,v.AU)(e,t):(0,y.AU)(e,t)).then((function(){return n(!1)}))}),1e3),j={isOpen:!1,isFetching:!0,isFiltering:!1,filterType:"state",filters:{state:[],owner:""},sortBy:{index:0,direction:m.SortByDirection.desc}},U=function(e,t){switch(t.type){case"setFetching":return N(N({},e),{isFetching:t.payload});case"setFilterValue":return N(N({},e),{filters:(r=t.payload,n=e.filterType,a=e.filters,N(N({},a),((o={})[n]=r,o)))});case"replaceFilterChip":return N(N({},e),{filters:t.payload});case"setFilteringFlag":return N(N({},e),{isFiltering:t.payload});case"setFilterType":return N(N({},e),{filterType:t.payload});case"setSortBy":return N(N({},e),{sortBy:t.payload,isFetching:!0})}var r,n,a,o;return e},L={0:"id",3:"owner",4:"created_at",6:"state"};const V=function(){var e,t,r,l,i,O,_=(0,k.Z)(),V=(0,s.useDispatch)(),G=(0,C.Z)(),H=(0,n.useReducer)(U,N(N({},j),{filters:(null===(e=null==G?void 0:G.orders)||void 0===e?void 0:e.filters)||{state:[],owner:""},sortBy:{direction:(null===(t=null==G?void 0:G.orders)||void 0===t?void 0:t.sortDirection)||m.SortByDirection.desc,index:(null===(r=null==G?void 0:G.orders)||void 0===r?void 0:r.sortIndex)||0}})),q=H[0],z=q.isFetching,W=q.isFiltering,J=q.filterType,K=q.filters,M=q.sortBy,Q=H[1],X=(0,s.useSelector)((function(e){return e.orderReducer.orders})),Y=(null===(l=window.catalog)||void 0===l?void 0:l.standalone)?X.results:X.data,$=(null===(i=window.catalog)||void 0===i?void 0:i.standalone)?{count:X.count,noData:!1}:X.meta;console.log("Debug - OrdersList - orders: ",X);var ee=[{title:_(S.Z.orderID)},_(P.Z.product),"",{title:_(S.Z.orderedByLabel)},{title:_(S.Z.orderDate)},_(P.Z.updated),{title:_(P.Z.status)}].map((function(e){return"object"!=typeof e||z||W||0===Y.length?e:N(N({},e),{transforms:[m.sortable]})})),te=(0,s.useSelector)((function(e){return e.portfolioReducer.portfolioItems})),re=(null===(O=window.catalog)||void 0===O?void 0:O.standalone)?te.results:te.data;console.log("Debug - data: ",Y);var ne=Y.map((function(e){var t=function(e,t){var r=e.orderItems,n=r&&r[0]&&t.find((function(e){var t=e.id;return r[0].portfolio_item_id===t}));return n?{orderPlatform:n.service_offering_source_ref,orderPortfolio:n.portfolio_id}:{}}(e,re),r=t.orderPlatform,l=t.orderPortfolio,i=function(e,t){var r=e.orderItems,n=e.id,a=r&&r[0]&&t.find((function(e){var t=e.id;return r[0].portfolio_item_id===t}));return a?a.name:"Order "+n}(e,re);return function(e,t,r,l){var i,s,c=e,d=B(B(B(B({order:e.id},c.id?{"order-item":c.id}:{}),c.portfolio_item?{"portfolio-item":c.portfolio_item}:{}),t?{platform:t}:{}),r?{portfolio:r}:{}),u=(0,T.C)(e.state);return[{title:a().createElement(m.TableText,null,a().createElement(w.Z,{pathname:x.A5,searchParams:d},e.id))},{title:a().createElement(n.Fragment,null,a().createElement(F.Z,{height:60,src:(i=e,s=i.orderItems,s&&s[0]&&Z.Vs+"/portfolio_items/"+s[0].portfolio_item_id+"/icon"),sourceId:t}))},e.orderName,e.owner,{title:a().createElement(o.Text,{className:"pf-u-mb-0",component:o.TextVariants.small},a().createElement(b.Z,{date:e.created_at,variant:"relative"}))},{title:a().createElement(o.Text,{className:"pf-u-mb-0",component:o.TextVariants.small},a().createElement(b.Z,{date:(null==e?void 0:e.orderItems)&&e.orderItems[0]&&e.orderItems[0].updated_at,variant:"relative"}))},{title:a().createElement(m.TableText,null,a().createElement(o.Label,B({},D.Z[e.state],{variant:"outline"}),l(T.Z[u])))}]}(N(N({},e),{orderName:i}),r,l,_)}));(0,n.useEffect)((function(){var e,t;Q({type:"setFetching",payload:!0}),Promise.all([V((null===(e=window.catalog)||void 0===e?void 0:e.standalone)?(0,v.AU)(K,null==G?void 0:G.orders):(0,y.AU)(K,null==G?void 0:G.orders)),V((null===(t=window.catalog)||void 0===t?void 0:t.standalone)?(0,h.dw)():(0,g.dw)())]).then((function(){return Q({type:"setFetching",payload:!1})}))}),[]);var ae=function(e,t){var r;return Q({type:"setFetching",payload:!0}),V((null===(r=window.catalog)||void 0===r?void 0:r.standalone)?(0,v.AU)(K,N(N({},t),{sortBy:L[M.index],sortDirection:M.direction,sortIndex:M.index})):(0,y.AU)(K,N(N({},t),{sortBy:L[M.index],sortDirection:M.direction,sortIndex:M.index}))).then((function(){return Q({type:"setFetching",payload:!1})})).catch((function(){return Q({type:"setFetching",payload:!1})}))},oe=function(e){var t;void 0===e&&(e=""),Q({type:"setFilterValue",payload:e}),R(N(N({},K),((t={})[J]=e,t)),N(N({},$),{sortBy:L[M.index],sortDirection:M.direction,sortIndex:M.index,offset:0}),V,(function(e){return Q({type:"setFilteringFlag",payload:e})}))},le=function(){return Q({type:"replaceFilterChip",payload:j.filters}),R(j.filters,N(N({},$),{sortBy:L[M.index],sortDirection:M.direction,sortIndex:M.index}),V,(function(e){return Q({type:"setFilteringFlag",payload:e})}))};return a().createElement(o.Grid,{hasGutter:!0},a().createElement(o.GridItem,null,a().createElement(c.Z,{type:"content"},!$.noData&&a().createElement(d.Z,{activeFiltersConfig:{filters:Object.entries(K).filter((function(e){var t=e[1];return t&&t.length>0})).map((function(e){var t=e[0],r=e[1];return{category:t,type:t,chips:Array.isArray(r)?r.map((function(e){return{name:e}})):[{name:r}]}})),onDelete:function(e,t,r){var n=t[0];if(r)return le();var a=N({},K);"state"===n.type?a[n.type]=a[n.type].filter((function(e){var t;return e!==(null===(t=null==n?void 0:n.chips)||void 0===t?void 0:t[0].name)})):a[n.type]="",Q({type:"replaceFilterChip",payload:a}),R(a,$,V,(function(e){return Q({type:"setFilteringFlag",payload:e})}))}},filterConfig:{onChange:function(e,t){return Q({type:"setFilterType",payload:t})},value:J,items:[{filterValues:{items:[{value:"Approval Pending",label:_(T.Z.approvalPending)},{value:"Canceled",label:_(T.Z.canceled)},{value:"Completed",label:_(T.Z.completed)},{value:"Created",label:_(P.Z.created)},{value:"Failed",label:_(T.Z.failed)},{value:"Ordered",label:_(T.Z.ordered)}],value:K.state,onChange:function(e,t){return oe(t)}},label:"State",value:"state",type:"checkbox"},{filterValues:{value:K.owner,onChange:function(e,t){return oe(t)}},label:"Owner",value:"owner"}]},pagination:a().createElement(I.Z,{isDisabled:z||W,apiRequest:ae,meta:$,isCompact:!0})}),a().createElement(m.Table,N({"aria-label":"orders"},z||W||0!==Y.length?{sortBy:M,onSort:function(e,t,r){var n;return Q({type:"setSortBy",payload:{index:t,direction:r}}),V((null===(n=window.catalog)||void 0===n?void 0:n.standalone)?(0,v.AU)(K,N(N({},$),{sortBy:L[t],sortDirection:r,sortIndex:t})):(0,y.AU)(K,N(N({},$),{sortBy:L[t],sortDirection:r,sortIndex:t}))).then((function(){return Q({type:"setFetching",payload:!1})}))}}:{},{cells:ee,rows:z||W?[]:ne,className:"orders-table"}),a().createElement(m.TableHeader,null),a().createElement(m.TableBody,null)),!(z||W)&&0===Y.length&&a().createElement(u.Z,null,a().createElement(o.Bullseye,null,a().createElement(o.EmptyState,null,a().createElement(o.Bullseye,null,a().createElement(o.EmptyStateIcon,{icon:f.SearchIcon})),a().createElement(o.Title,{headingLevel:"h1",size:"lg"},$.noData?_(S.Z.noOrdersTitle):_(A.Z.noResults)),a().createElement(o.EmptyStateBody,null,$.noData?_(S.Z.noOrdersDescription):_(A.Z.noResultsDescription)),!$.noData&&a().createElement(o.EmptyStateSecondaryActions,null,a().createElement(o.Button,{ouiaId:"clear-filter",variant:"link",onClick:le},_(A.Z.clearFilters)))))),(z||W)&&a().createElement(E.Wi,null),a().createElement(p.Z,{className:"pf-u-mr-0"},a().createElement("div",{className:"bottom-pagination-container"},a().createElement(o.Flex,{justifyContent:{default:"justifyContentFlexEnd"}},$&&$.count>0&&a().createElement(I.Z,{className:"pf-u-mt-0",isDisabled:z||W,apiRequest:ae,meta:$})))))))},G=function(){return a().createElement(o.Stack,null,a().createElement(l.Z,{schema:{fields:[{component:i.H.TOP_TOOLBAR,className:"orders pf-u-p-lg",key:"orders-toolbar",fields:[{component:i.H.TOP_TOOLBAR_TITLE,key:"orders-toolbar-title",title:"Orders",className:""}]}]}}),a().createElement(V,null))}}}]);
//# sourceMappingURL=../sourcemaps/orders.e4163d1cc2a6ed1526449d160289ec59.js.map